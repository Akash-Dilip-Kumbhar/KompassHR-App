<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luminous Glass UI - Notifications</title>

    <!-- Google Fonts: Outfit -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>

<body class="bg-luminous pb-5 mb-5">

    <!-- Luminous Blobs Background -->
    <div class="bg-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <!-- Mobile Wrapper -->
    <div class="mobile-wrapper pb-5" style="min-height: 100vh;">

        <!-- App Content -->
        <div class="app-content pb-5">
            <!-- Header -->
            <header class="d-flex align-items-center mb-4 pt-4 px-3 gap-3">
                <a href="dashboard.html"
                    class="btn btn-light rounded-circle shadow-sm d-flex justify-content-center align-items-center"
                    style="width: 40px; height: 40px;">
                    <i class="bi bi-arrow-left fs-5 text-dark"></i>
                </a>
                <h2 class="h4 fw-bold mb-0 text-dark">Notifications</h2>
                <div class="ms-auto">
                    <button id="markAllReadBtn" class="btn btn-sm btn-soft-primary fw-bold text-uppercase"
                        style="font-size: 0.7rem; padding: 0.4rem 0.8rem;">Mark All Read</button>
                </div>
            </header>

            <!-- Notifications List -->
            <div id="notificationsContainer" class="px-3 d-flex flex-column gap-3">

                <!-- Unread Notification (New Leave Request) -->
                <div class="glass-effect p-3 rounded-4 d-flex gap-3 position-relative overflow-hidden"
                    style="border-left: 4px solid var(--primary-color);">
                    <div class="position-absolute top-0 end-0 p-2">
                        <span class="badge bg-primary rounded-pill" style="font-size: 0.5rem;">NEW</span>
                    </div>
                    <div class="bg-soft-primary rounded-circle d-flex justify-content-center align-items-center flex-shrink-0 mt-1"
                        style="width: 45px; height: 45px;">
                        <i class="bi bi-file-earmark-text-fill text-primary fs-5"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h6 class="mb-1 fw-bold text-dark small">Leave Request Approved</h6>
                        <p class="mb-2 text-muted" style="font-size: 0.8rem; line-height: 1.4;">Your Sick Leave request
                            for 12 Aug - 14 Aug has been approved by your manager.</p>
                        <p class="mb-0 text-primary fw-bold" style="font-size: 0.65rem;">10 MINS AGO</p>
                    </div>
                </div>

                <!-- Unread Notification (Announcement) -->
                <div class="glass-effect p-3 rounded-4 d-flex gap-3 position-relative overflow-hidden"
                    style="border-left: 4px solid var(--warning-color);">
                    <div class="position-absolute top-0 end-0 p-2">
                        <span class="badge bg-primary rounded-pill" style="font-size: 0.5rem;">NEW</span>
                    </div>
                    <div class="bg-soft-warning rounded-circle d-flex justify-content-center align-items-center flex-shrink-0 mt-1"
                        style="width: 45px; height: 45px;">
                        <i class="bi bi-megaphone-fill text-warning fs-5"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h6 class="mb-1 fw-bold text-dark small">Townhall Meeting Remaining</h6>
                        <p class="mb-2 text-muted" style="font-size: 0.8rem; line-height: 1.4;">Reminder: The quarterly
                            company townhall starts in 30 minutes in the main cafeteria.</p>
                        <p class="mb-0 text-primary fw-bold" style="font-size: 0.65rem;">30 MINS AGO</p>
                    </div>
                </div>

                <!-- Read Notification (Payroll) -->
                <div class="glass-effect p-3 rounded-4 d-flex gap-3 opacity-75">
                    <div class="bg-soft-success rounded-circle d-flex justify-content-center align-items-center flex-shrink-0 mt-1"
                        style="width: 45px; height: 45px;">
                        <i class="bi bi-cash-stack text-success fs-5"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h6 class="mb-1 fw-bold text-dark small">Payslip Generated</h6>
                        <p class="mb-2 text-muted" style="font-size: 0.8rem; line-height: 1.4;">Your payslip for the
                            month of July is now available to dimension and review.</p>
                        <p class="mb-0 text-muted fw-bold" style="font-size: 0.65rem;">YESTERDAY</p>
                    </div>
                </div>

                <!-- Read Notification (System Update) -->
                <div class="glass-effect p-3 rounded-4 d-flex gap-3 opacity-75">
                    <div class="bg-soft-secondary rounded-circle d-flex justify-content-center align-items-center flex-shrink-0 mt-1"
                        style="width: 45px; height: 45px;">
                        <i class="bi bi-gear-fill text-secondary fs-5"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h6 class="mb-1 fw-bold text-dark small">System Maintenance</h6>
                        <p class="mb-2 text-muted" style="font-size: 0.8rem; line-height: 1.4;">KompassHR will be
                            undergoing scheduled maintenance this Sunday from 2 AM to 4 AM.</p>
                        <p class="mb-0 text-muted fw-bold" style="font-size: 0.65rem;">2 DAYS AGO</p>
                    </div>
                </div>

                <!-- Read Notification (Birthday) -->
                <div class="glass-effect p-3 rounded-4 d-flex gap-3 opacity-75">
                    <div class="bg-soft-danger rounded-circle d-flex justify-content-center align-items-center flex-shrink-0 mt-1"
                        style="width: 45px; height: 45px;">
                        <i class="bi bi-balloon-fill text-danger fs-5"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h6 class="mb-1 fw-bold text-dark small">Wish Happy Birthday!</h6>
                        <p class="mb-2 text-muted" style="font-size: 0.8rem; line-height: 1.4;">Today is Sarah's
                            birthday! Tap here to send her a quick greeting.</p>
                        <p class="mb-0 text-muted fw-bold" style="font-size: 0.65rem;">3 DAYS AGO</p>
                    </div>
                </div>

            </div>

        </div> <!-- End App Content -->
    </div>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.css"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const markAllReadBtn = document.getElementById('markAllReadBtn');
            const notificationsContainer = document.getElementById('notificationsContainer');

            // Helper to show empty state when all notifications are cleared
            const checkEmptyState = () => {
                const remaining = Array.from(notificationsContainer.children).filter(child => !child.classList.contains('empty-state'));
                if (remaining.length === 0 && !notificationsContainer.querySelector('.empty-state')) {
                    const emptyState = document.createElement('div');
                    emptyState.className = 'empty-state text-center mt-5 p-4 animate-fade-up';
                    emptyState.style.animationDelay = '0.2s';
                    emptyState.innerHTML = `
                        <div class="mb-3 d-inline-flex justify-content-center align-items-center rounded-circle bg-soft-success" style="width: 80px; height: 80px;">
                            <i class="bi bi-check2-all text-success" style="font-size: 2.5rem;"></i>
                        </div>
                        <h4 class="fw-bold text-dark mt-3 h5">You're all caught up!</h4>
                        <p class="text-muted small">No new notifications right now.</p>
                    `;
                    notificationsContainer.appendChild(emptyState);

                    if (markAllReadBtn) {
                        markAllReadBtn.disabled = true;
                        markAllReadBtn.classList.replace('btn-soft-primary', 'btn-light');
                        markAllReadBtn.classList.add('text-muted');
                    }
                }
            };

            // Setup Mark All Read functionality
            if (markAllReadBtn && notificationsContainer) {
                markAllReadBtn.addEventListener('click', () => {
                    const notifications = Array.from(notificationsContainer.children).filter(child => !child.classList.contains('empty-state'));
                    if (notifications.length === 0) return;

                    markAllReadBtn.style.transform = 'scale(0.95)';
                    setTimeout(() => markAllReadBtn.style.transform = 'scale(1)', 150);

                    notifications.forEach((notif, index) => {
                        notif.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                        notif.style.transitionDelay = `${index * 50}ms`;
                        setTimeout(() => {
                            notif.style.opacity = '0';
                            notif.style.transform = 'translateX(100%)';
                        }, 50);
                    });

                    const totalAnimationTime = 400 + (notifications.length * 50);
                    setTimeout(() => {
                        notificationsContainer.innerHTML = '';
                        checkEmptyState();
                    }, totalAnimationTime);
                });
            }

            // Setup Mobile Swipe-to-Dismiss for individual notifications
            if (notificationsContainer) {
                // Select all current notifications built-in
                const notificationItems = notificationsContainer.querySelectorAll('.glass-effect');

                notificationItems.forEach(notif => {
                    let startX = 0;
                    let currentX = 0;
                    let isSwiping = false;

                    notif.addEventListener('touchstart', (e) => {
                        startX = e.touches[0].clientX;
                        currentX = startX;
                        isSwiping = true;
                        notif.style.transition = 'none'; // Disable CSS transitions for instant dragging
                    }, { passive: true });

                    notif.addEventListener('touchmove', (e) => {
                        if (!isSwiping) return;
                        currentX = e.touches[0].clientX;
                        const deltaX = currentX - startX;

                        // Only slide to the right
                        if (deltaX > 0) {
                            notif.style.transform = `translateX(${deltaX}px)`;
                            // Fade out dynamically based on swipe distance
                            notif.style.opacity = Math.max(0, 1 - (deltaX / window.innerWidth) * 1.5).toString();
                        }
                    }, { passive: true });

                    notif.addEventListener('touchend', () => {
                        if (!isSwiping) return;
                        isSwiping = false;

                        const deltaX = currentX - startX;
                        const swipeThreshold = 100; // minimum pixels to dismiss

                        // Re-enable smooth transition for the finish animation
                        notif.style.transition = 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)';

                        if (deltaX > swipeThreshold) {
                            // Committing dismiss: slide all the way and fade
                            notif.style.transform = 'translateX(100%)';
                            notif.style.opacity = '0';

                            // Remove from DOM when animation is guaranteed done
                            setTimeout(() => {
                                notif.style.display = 'none'; // Collapse space cleanly
                                setTimeout(() => {
                                    notif.remove();
                                    checkEmptyState(); // Check if list is empty now
                                }, 10);
                            }, 300);
                        } else {
                            // Cancel dismiss: Snap back
                            notif.style.transform = 'translateX(0)';
                            notif.style.opacity = '1';
                        }
                    });
                });
            }
        });
    </script>
</body>

</html>